import"../chunks/CWj6FrbW.js";import{j as ce,d as J,a as d,E as Ae,p as Pe,h as k,V as je,U as Ye,f,c as o,g as e,s as _,i as s,l as ot,b as Ne,r,n as Y,N as Ee,m as N,o as G,u as at,aP as st}from"../chunks/OF3EgmvO.js";import{B as Ce,A as it}from"../chunks/BGciXxwI.js";import{i as S}from"../chunks/wlFoaW_T.js";import{I as Me,s as De,e as We,i as Je}from"../chunks/DzfTeG5e.js";import{g as Ue}from"../chunks/Dky2jAKs.js";import{I as Qe}from"../chunks/DaUql_yn.js";import{B as nt,s as de,d as Xe}from"../chunks/DrwkzclB.js";import{B as lt}from"../chunks/BehU5LlY.js";import{c as Ke}from"../chunks/BUrUeTJj.js";import"../chunks/gg-Huw4A.js";import{l as Fe,s as Be,p as dt}from"../chunks/QIIHtePh.js";import{L as Re}from"../chunks/peaLEW31.js";import{C as ct,a as ut}from"../chunks/GvTUSVzd.js";import{S as Ve}from"../chunks/CnjVKNr5.js";function vt(j,c){const h=Fe(c,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i=[["path",{d:"m15 18-6-6 6-6"}]];Me(j,Be({name:"chevron-left"},()=>h,{get iconNode(){return i},children:(g,y)=>{var u=ce(),v=J(u);De(v,c,"default",{}),d(g,u)},$$slots:{default:!0}}))}function ft(j,c){const h=Fe(c,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i=[["path",{d:"m9 18 6-6-6-6"}]];Me(j,Be({name:"chevron-right"},()=>h,{get iconNode(){return i},children:(g,y)=>{var u=ce(),v=J(u);De(v,c,"default",{}),d(g,u)},$$slots:{default:!0}}))}function _t(j,c){const h=Fe(c,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];Me(j,Be({name:"refresh-cw"},()=>h,{get iconNode(){return i},children:(g,y)=>{var u=ce(),v=J(u);De(v,c,"default",{}),d(g,u)},$$slots:{default:!0}}))}function mt(j,c){const h=Fe(c,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i=[["circle",{cx:"11",cy:"11",r:"8"}],["path",{d:"m21 21-4.3-4.3"}]];Me(j,Be({name:"search"},()=>h,{get iconNode(){return i},children:(g,y)=>{var u=ce(),v=J(u);De(v,c,"default",{}),d(g,u)},$$slots:{default:!0}}))}const ht=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function gt(j){return ht.test(j)}var pt=f("<!> Hide filters",1),bt=f("<!> Show filters",1),wt=f('<div class="pt-1"><!></div>'),yt=f('<span class="flex items-center gap-2"><!> Loading more results...</span>'),xt=f("<span>Show More from Google Books</span>"),kt=f('<div class="flex justify-center pt-4"><!></div>'),$t=f('<div class="space-y-4"><h2 class="text-lg font-semibold"> </h2> <!> <!></div>'),St=f('<div class="py-12 text-center"><p class="text-muted-foreground"> </p></div>'),It=f('<div><form class="mb-8"><div class="space-y-3"><div class="relative"><!> <!> <!></div> <div class="flex items-center gap-2"><button type="button" class="flex items-center gap-1 text-xs text-muted-foreground transition-colors hover:text-foreground"><!></button></div> <!></div></form> <!> <!></div>');function Tt(j,c){Pe(c,!0);const h=Ke();let i=k(""),g=k(""),y=k(!1),u=k(je([])),v=k(!1),I=k(!1),p=k(!1),T=k(!1),D=k(!1),M=k(je(new Set)),X=k(je(new Set)),H=null;Ye(()=>{c.userId&&K()});function ye(t){if(s(i,t,!0),H&&clearTimeout(H),!t.trim()){s(u,[],!0),s(I,!1),s(p,!1),s(T,!1);return}H=setTimeout(()=>{ue()},500)}async function ue(){const t=e(i).trim();if(!t){s(u,[],!0),s(I,!1);return}s(v,!0),s(I,!0),s(T,!1);try{let n=`/api/books/search?q=${encodeURIComponent(t)}&source=database`;e(g).trim()&&(n+=`&author=${encodeURIComponent(e(g).trim())}`);const a=await fetch(n);if(!a.ok)throw new Error("Failed to search books");const l=await a.json();s(u,l,!0),s(p,l.length>0),await K()}catch(n){console.error("Search error:",n),s(u,[],!0),s(p,!1)}finally{s(v,!1)}}async function xe(){const t=e(i).trim();if(t){s(D,!0);try{let n=`/api/books/search?q=${encodeURIComponent(t)}&source=api`;e(g).trim()&&(n+=`&author=${encodeURIComponent(e(g).trim())}`);const a=await fetch(n);if(!a.ok)throw new Error("Failed to load additional results");const l=await a.json(),W=new Set(e(u).map(se=>se.google_books_id)),ae=l.filter(se=>!W.has(se.google_books_id));s(u,[...e(u),...ae],!0),s(T,!0)}catch(n){console.error("Error loading more results:",n)}finally{s(D,!1)}}}function C(t){t.preventDefault(),H&&clearTimeout(H),ue()}function $(t){t.key==="Enter"&&(t.preventDefault(),H&&clearTimeout(H),ue())}async function K(){try{const[{data:t},{data:n}]=await Promise.all([h.from("wishlists").select("books(google_books_id)").eq("user_id",c.userId),h.from("completed_books").select("books(google_books_id)").eq("user_id",c.userId)]);s(M,new Set((t||[]).map(a=>{var l;return(l=a.books)==null?void 0:l.google_books_id}).filter(a=>!!a)),!0),s(X,new Set((n||[]).map(a=>{var l;return(l=a.books)==null?void 0:l.google_books_id}).filter(a=>!!a)),!0)}catch(t){console.error("Error loading book statuses:",t)}}async function m(){const{data:{user:t}}=await h.auth.getUser();return t||(Ue("/login"),null)}async function b(t){if(t.id&&gt(t.id))return t.id;if(t.google_books_id){const{data:n}=await h.from("books").select("id").eq("google_books_id",t.google_books_id).single();if(n!=null&&n.id)return n.id;const a=await fetch(`/api/books/fetch?id=${t.google_books_id}`);if(!a.ok)return null;const l=await a.json();return(l==null?void 0:l.id)??null}return null}async function E(t){const n=await m();if(n)try{const a=await b(t);if(!a)throw new Error("Unable to save book");const{error:l}=await h.from("wishlists").insert({user_id:n.id,book_id:a});if(l&&l.code!=="23505")throw l;s(M,new Set([...e(M),t.google_books_id]),!0),s(X,new Set([...e(X)].filter(W=>W!==t.google_books_id)),!0)}catch(a){console.error("Error adding to wishlist:",a),alert("Failed to add to wishlist. Please try again.")}}async function R(t){const n=await m();if(n)try{const a=await b(t);if(!a)throw new Error("Unable to save book");const{data:l}=await h.from("completed_books").select("id").eq("user_id",n.id).eq("book_id",a).single();if(l){Ue(`/rate/${a}`);return}await h.from("wishlists").delete().eq("user_id",n.id).eq("book_id",a),await h.from("currently_reading").delete().eq("user_id",n.id).eq("book_id",a);const{error:W}=await h.from("completed_books").insert({user_id:n.id,book_id:a});if(W)throw W;s(X,new Set([...e(X),t.google_books_id]),!0),s(M,new Set([...e(M)].filter(ae=>ae!==t.google_books_id)),!0),Ue(`/rate/${a}`)}catch(a){console.error("Error marking as complete:",a),alert("Failed to mark as complete. Please try again.")}}var O=It(),q=o(O),F=o(q),A=o(F),Q=o(A);mt(Q,{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"});var B=_(Q,2);Qe(B,{type:"search",placeholder:"Search by title...",class:"h-12 pl-9",get value(){return e(i)},oninput:t=>ye(t.currentTarget.value),onkeydown:$});var Z=_(B,2);{var V=t=>{Re(t,{class:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-muted-foreground"})};S(Z,t=>{e(v)&&t(V)})}r(A);var re=_(A,2),oe=o(re);oe.__click=()=>s(y,!e(y));var ve=o(oe);{var ge=t=>{var n=pt(),a=J(n);ct(a,{class:"h-3 w-3"}),Y(),d(t,n)},pe=t=>{var n=bt(),a=J(n);ut(a,{class:"h-3 w-3"}),Y(),d(t,n)};S(ve,t=>{e(y)?t(ge):t(pe,!1)})}r(oe),r(re);var Ie=_(re,2);{var ke=t=>{var n=wt(),a=o(n);Qe(a,{id:"author",type:"text",placeholder:"Filter by author (optional)",onkeydown:$,class:"h-10",get value(){return e(g)},set value(l){s(g,l,!0)}}),r(n),d(t,n)};S(Ie,t=>{e(y)&&t(ke)})}r(F),r(q);var be=_(q,2);{var x=t=>{var n=$t(),a=o(n),l=o(a);r(a);var W=_(a,2);We(W,17,()=>e(u),ie=>ie.google_books_id,(ie,ee)=>{{let fe=Ee(()=>e(M).has(e(ee).google_books_id)),$e=Ee(()=>e(X).has(e(ee).google_books_id));lt(ie,{get book(){return e(ee)},onAddToWishlist:E,onMarkComplete:R,get isInWishlist(){return e(fe)},get isCompleted(){return e($e)}})}});var ae=_(W,2);{var se=ie=>{var ee=kt(),fe=o(ee);nt(fe,{type:"button",onclick:xe,get disabled(){return e(D)},size:"sm",class:"flex items-center gap-2",children:($e,He)=>{var Se=ce(),ze=J(Se);{var Te=_e=>{var ne=yt(),Le=o(ne);Re(Le,{class:"h-4 w-4 animate-spin"}),Y(),r(ne),d(_e,ne)},qe=_e=>{var ne=xt();d(_e,ne)};S(ze,_e=>{e(D)?_e(Te):_e(qe,!1)})}d($e,Se)},$$slots:{default:!0}}),r(ee),d(ie,ee)};S(ae,ie=>{e(p)&&!e(T)&&ie(se)})}r(n),N(()=>G(l,`Found ${e(u).length??""} ${e(u).length===1?"book":"books"}`)),d(t,n)};S(be,t=>{e(u).length>0&&t(x)})}var w=_(be,2);{var U=t=>{var n=St(),a=o(n),l=o(a);r(a),r(n),N(()=>G(l,`No books found for "${e(i)??""}". Try a different search term.`)),d(t,n)};S(w,t=>{!e(v)&&e(I)&&e(u).length===0&&t(U)})}r(O),ot("submit",q,C),d(j,O),Ne()}Ae(["click"]);var jt=f('<img class="h-full w-full object-cover" loading="lazy"/>'),Ct=f('<div class="flex h-full w-full items-center justify-center"><!></div>'),Et=f('<div class="absolute right-2 top-2 rounded-full bg-primary p-1 text-primary-foreground"><!></div>'),Rt=f('<span class="flex items-center gap-2"><!> <span>Adding...</span></span>'),qt=f('<span class="flex items-center gap-2"><!> <span>Want to Read</span></span>'),Ut=f('<button type="button" class="mt-auto flex items-center justify-center gap-2 rounded-md bg-primary py-2 text-sm text-primary-foreground transition-colors hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-60"><!></button>'),Wt=f('<button type="button"></button>'),At=f('<div class="relative"><div class="min-h-[280px] rounded-lg border bg-card p-4"><div class="flex gap-4"><a class="relative h-44 w-32 flex-shrink-0 overflow-hidden rounded-md bg-muted transition-opacity hover:opacity-80"><!> <!></a> <div class="flex flex-1 flex-col"><a><h3 class="font-semibold leading-tight transition-colors hover:text-primary line-clamp-2"> </h3></a> <p class="mt-1 text-sm text-muted-foreground"> </p> <p class="mt-2 text-sm italic text-primary/80 line-clamp-2"> </p> <p class="mt-2 text-xs text-muted-foreground line-clamp-3"> </p> <!></div></div></div> <div class="mt-3 flex justify-center gap-1.5"></div></div>');function Pt(j,c){Pe(c,!0);let h=dt(c,"addingToWishlist",3,null),i=k(0),g=k(null),y=k(null),u=null;const v=Ee(()=>c.books[e(i)]),I=Ee(()=>e(v)?c.wishlistIds.has(e(v).google_books_id):!1);function p(){T(),c.books.length&&(u=setInterval(()=>{s(i,(e(i)+1)%c.books.length)},1e4))}function T(){u&&(clearInterval(u),u=null)}at(()=>{if(!c.books.length){T();return}return p(),()=>T()}),st(T);function D(C){var $;s(g,(($=C.touches[0])==null?void 0:$.clientX)??null,!0)}function M(C){var $;s(y,(($=C.touches[0])==null?void 0:$.clientX)??null,!0)}function X(){if(!e(g)||!e(y))return;const C=e(g)-e(y),$=C>50,K=C<-50;$?s(i,(e(i)+1)%c.books.length):K&&s(i,(e(i)-1+c.books.length)%c.books.length),s(g,null),s(y,null)}function H(C){C.preventDefault(),!(!e(v)||e(I))&&c.onAddToWishlist(e(v).google_books_id)}var ye=ce(),ue=J(ye);{var xe=C=>{var $=At();$.__touchstart=D,$.__touchmove=M,$.__touchend=X;var K=o($),m=o(K),b=o(m),E=o(b);{var R=x=>{var w=jt();N(()=>{de(w,"src",e(v).cover_url),de(w,"alt",`Cover of ${e(v).title}`)}),d(x,w)},O=x=>{var w=Ct(),U=o(w);Ce(U,{class:"h-12 w-12 text-muted-foreground"}),r(w),d(x,w)};S(E,x=>{e(v).cover_url?x(R):x(O,!1)})}var q=_(E,2);{var F=x=>{var w=Et(),U=o(w);Ce(U,{class:"h-3 w-3"}),r(w),d(x,w)};S(q,x=>{e(I)&&x(F)})}r(b);var A=_(b,2),Q=o(A),B=o(Q),Z=o(B,!0);r(B),r(Q);var V=_(Q,2),re=o(V,!0);r(V);var oe=_(V,2),ve=o(oe,!0);r(oe);var ge=_(oe,2),pe=o(ge,!0);r(ge);var Ie=_(ge,2);{var ke=x=>{var w=Ut();w.__click=H;var U=o(w);{var t=a=>{var l=Rt(),W=o(l);Re(W,{class:"h-4 w-4 animate-spin"}),Y(2),r(l),d(a,l)},n=a=>{var l=qt(),W=o(l);Ce(W,{class:"h-4 w-4"}),Y(2),r(l),d(a,l)};S(U,a=>{h()===e(v).google_books_id?a(t):a(n,!1)})}r(w),N(()=>w.disabled=h()===e(v).google_books_id),d(x,w)};S(Ie,x=>{e(I)||x(ke)})}r(A),r(m),r(K);var be=_(K,2);We(be,21,()=>c.books,Je,(x,w,U)=>{var t=Wt();t.__click=()=>s(i,U,!0),de(t,"aria-label",`Go to recommendation ${U+1}`),N(()=>Xe(t,1,`h-1.5 rounded-full transition-all ${U===e(i)?"w-6 bg-primary":"w-1.5 bg-muted-foreground/30"}`)),d(x,t)}),r(be),r($),N(x=>{de(b,"href",`/book/${e(v).google_books_id}`),de(Q,"href",`/book/${e(v).google_books_id}`),G(Z,e(v).title),G(re,x),G(ve,e(v).reason),G(pe,e(v).blurb)},[()=>e(v).authors.join(", ")]),d(C,$)};S(ue,C=>{e(v)&&C(xe)})}d(j,ye),Ne()}Ae(["touchstart","touchmove","touchend","click"]);Ae(["click"]);var Nt=f('<div class="flex items-center justify-center py-12"><!></div>'),Mt=f('<div class="space-y-3"><div class="flex items-center gap-2"><!> <h2 class="text-lg font-semibold">Recommended For You</h2></div> <div class="rounded-lg border border-dashed bg-muted/50 p-6 text-center"><p class="text-sm text-muted-foreground"> </p></div></div>'),Dt=f('<img class="h-full w-full object-cover"/>'),Ft=f('<div class="flex h-full w-full items-center justify-center bg-muted"><!></div>'),Bt=f('<button type="button"><!></button>'),zt=f('<span class="flex items-center gap-2"><!> <span>Adding...</span></span>'),Lt=f('<span class="flex items-center gap-2"><!> <span>Want to Read</span></span>'),Gt=f('<button type="button" class="mt-2 flex w-full items-center justify-center gap-2 rounded-lg bg-primary px-6 py-3 font-medium text-primary-foreground transition-colors hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-50 sm:w-auto"><!></button>'),Xt=f('<div class="text-sm text-muted-foreground">Already in your wishlist</div>'),Ht=f('<button type="button"></button>'),Ot=f('<div class="rounded-lg border bg-card p-8"><div class="relative"><div class="mx-auto flex max-w-3xl flex-col gap-6"><div class="flex items-center justify-center gap-4"><button type="button" class="flex-shrink-0 rounded-full border bg-background/95 p-2 transition-colors hover:bg-accent" aria-label="Previous recommendation"><!></button> <div class="flex gap-3"></div> <button type="button" class="flex-shrink-0 rounded-full border bg-background/95 p-2 transition-colors hover:bg-accent" aria-label="Next recommendation"><!></button></div> <div class="flex flex-col gap-4"><a><h3 class="text-xl font-bold transition-colors hover:text-primary"> </h3></a> <p class="text-sm text-muted-foreground"> </p> <div class="rounded-lg border border-primary/10 bg-primary/5 p-4"><p class="text-sm font-medium italic text-primary/90"> </p></div> <p class="text-sm leading-relaxed text-muted-foreground"> </p> <!></div></div></div> <div class="mt-8 flex justify-center gap-2"></div></div>'),Qt=f('<div class="space-y-3"><div class="flex items-center justify-between"><div class="flex items-center gap-2"><!> <h2 class="text-lg font-semibold">Recommended For You</h2></div> <button type="button" class="rounded-full p-2 text-muted-foreground transition-colors hover:text-foreground disabled:opacity-50" aria-label="Refresh recommendations"><!></button></div> <div class="block md:hidden"><!></div> <div class="hidden md:block"><!></div> <p class="text-xs text-muted-foreground">AI-powered â€¢ Refreshes after 5 days or 3 wishlist adds</p></div>');function Vt(j,c){Pe(c,!0);const h=Ke();let i=k(je([])),g=k(!0),y=k(!1),u=k(null),v=k(!1),I=k(je(new Set)),p=k(0),T=k(null);async function D(m=!1){try{m?s(y,!0):s(g,!0),s(u,null);const R=await(await fetch(`/api/recommendations${m?"?forceRefresh=1":""}`)).json();if(R.error){s(u,R.error,!0),s(i,[],!0);return}s(i,R.recommendations||[],!0),s(v,R.fromCache,!0),s(p,0)}catch(b){console.error("Error loading recommendations:",b),s(u,"Failed to load recommendations"),s(i,[],!0)}finally{s(g,!1),s(y,!1)}}async function M(){try{const{data:m}=await h.from("wishlists").select("books(google_books_id)").eq("user_id",c.userId),b=new Set((m||[]).map(E=>{var R;return(R=E.books)==null?void 0:R.google_books_id}).filter(E=>!!E));s(I,b,!0)}catch(m){console.error("Error loading wishlist status:",m)}}async function X(m){if(e(T)!==m){s(T,m,!0);try{const{data:{user:b}}=await h.auth.getUser();if(!b){Ue("/login");return}const{data:E}=await h.from("books").select("id").eq("google_books_id",m).single();let R=E==null?void 0:E.id;if(!R){const q=await fetch(`/api/books/fetch?id=${m}`);if(!q.ok){const A=await q.json();throw new Error(A.error||"Unable to fetch book")}R=(await q.json()).id}const{error:O}=await h.from("wishlists").insert({user_id:b.id,book_id:R});if(O&&O.code!=="23505")throw O;s(I,new Set([...e(I),m]),!0),await fetch("/api/recommendations/track",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:m})})}catch(b){console.error("Error adding to wishlist:",b),alert(b instanceof Error?b.message:"Failed to add to wishlist")}finally{s(T,null)}}}function H(){e(i).length&&s(p,(e(p)-1+e(i).length)%e(i).length)}function ye(){e(i).length&&s(p,(e(p)+1)%e(i).length)}function ue(m){s(p,m,!0)}Ye(()=>{D(),M()});var xe=ce(),C=J(xe);{var $=m=>{var b=Nt(),E=o(b);Re(E,{class:"h-6 w-6 animate-spin text-muted-foreground"}),r(b),d(m,b)},K=m=>{var b=ce(),E=J(b);{var R=q=>{var F=Mt(),A=o(F),Q=o(A);Ve(Q,{class:"h-4 w-4 text-primary"}),Y(2),r(A);var B=_(A,2),Z=o(B),V=o(Z,!0);r(Z),r(B),r(F),N(()=>G(V,e(u))),d(q,F)},O=q=>{var F=ce(),A=J(F);{var Q=B=>{var Z=Qt(),V=o(Z),re=o(V),oe=o(re);Ve(oe,{class:"h-4 w-4 text-primary"}),Y(2),r(re);var ve=_(re,2);ve.__click=()=>D(!0);var ge=o(ve);{let w=Ee(()=>`h-4 w-4 ${e(y)?"animate-spin":""}`);_t(ge,{get class(){return e(w)}})}r(ve),r(V);var pe=_(V,2),Ie=o(pe);Pt(Ie,{get books(){return e(i)},onAddToWishlist:X,get wishlistIds(){return e(I)},get addingToWishlist(){return e(T)}}),r(pe);var ke=_(pe,2),be=o(ke);{var x=w=>{var U=Ot(),t=o(U),n=o(t),a=o(n),l=o(a);l.__click=H;var W=o(l);vt(W,{class:"h-5 w-5"}),r(l);var ae=_(l,2);We(ae,23,()=>e(i),P=>P.google_books_id,(P,z,me)=>{var L=Bt();L.__click=()=>ue(e(me));var Ge=o(L);{var he=te=>{var we=Dt();N(()=>{de(we,"src",e(z).cover_url),de(we,"alt",`Cover of ${e(z).title}`)}),d(te,we)},le=te=>{var we=Ft(),rt=o(we);Ce(rt,{class:"h-6 w-6 text-muted-foreground"}),r(we),d(te,we)};S(Ge,te=>{e(z).cover_url?te(he):te(le,!1)})}r(L),N(()=>Xe(L,1,`relative h-24 w-16 overflow-hidden rounded-md transition-all ${e(me)===e(p)?"ring-2 ring-primary ring-offset-2 ring-offset-background scale-105":"opacity-60 hover:opacity-100 hover:scale-105"}`)),d(P,L)}),r(ae);var se=_(ae,2);se.__click=ye;var ie=o(se);ft(ie,{class:"h-5 w-5"}),r(se),r(a);var ee=_(a,2),fe=o(ee),$e=o(fe),He=o($e,!0);r($e),r(fe);var Se=_(fe,2),ze=o(Se);r(Se);var Te=_(Se,2),qe=o(Te),_e=o(qe,!0);r(qe),r(Te);var ne=_(Te,2),Le=o(ne,!0);r(ne);var Ze=_(ne,2);{var et=P=>{var z=Gt();z.__click=()=>X(e(i)[e(p)].google_books_id);var me=o(z);{var L=he=>{var le=zt(),te=o(le);Re(te,{class:"h-5 w-5 animate-spin"}),Y(2),r(le),d(he,le)},Ge=he=>{var le=Lt(),te=o(le);Ce(te,{class:"h-5 w-5"}),Y(2),r(le),d(he,le)};S(me,he=>{e(T)===e(i)[e(p)].google_books_id?he(L):he(Ge,!1)})}r(z),N(()=>z.disabled=e(T)===e(i)[e(p)].google_books_id),d(P,z)},tt=P=>{var z=Xt();d(P,z)};S(Ze,P=>{e(I).has(e(i)[e(p)].google_books_id)?P(tt,!1):P(et)})}r(ee),r(n),r(t);var Oe=_(t,2);We(Oe,21,()=>e(i),Je,(P,z,me)=>{var L=Ht();L.__click=()=>ue(me),de(L,"aria-label",`Go to recommendation ${me+1}`),N(()=>Xe(L,1,`h-2 rounded-full transition-all ${me===e(p)?"w-8 bg-primary":"w-2 bg-muted-foreground/30 hover:bg-muted-foreground/50"}`)),d(P,L)}),r(Oe),r(U),N(P=>{de(fe,"href",`/book/${e(i)[e(p)].google_books_id}`),G(He,e(i)[e(p)].title),G(ze,`by ${P??""}`),G(_e,e(i)[e(p)].reason),G(Le,e(i)[e(p)].blurb)},[()=>e(i)[e(p)].authors.join(", ")]),d(w,U)};S(be,w=>{e(i)[e(p)]&&w(x)})}r(ke),Y(2),r(Z),N(()=>ve.disabled=e(y)),d(B,Z)};S(A,B=>{e(i).length>0&&B(Q)},!0)}d(q,F)};S(E,q=>{e(u)?q(R):q(O,!1)},!0)}d(m,b)};S(C,m=>{e(g)&&e(i).length===0?m($):m(K,!1)})}d(j,xe),Ne()}Ae(["click"]);var Yt=f('<div class="mx-auto max-w-5xl px-4 py-6"><div class="mb-6 space-y-1"><h1 class="page-heading"> </h1> <p class="text-sm text-muted-foreground"><span class="meta-label">Discover worlds you might love</span></p></div> <div class="mb-8"><!></div> <!></div>');function vr(j,c){Pe(c,!0),it(j,{children:(h,i)=>{var g=Yt(),y=o(g),u=o(y),v=o(u);r(u),Y(2),r(y);var I=_(y,2),p=o(I);Tt(p,{get userId(){return c.data.userId}}),r(I);var T=_(I,2);Vt(T,{get userId(){return c.data.userId}}),r(g),N(()=>{var D,M;return G(v,`Welcome back, ${(((D=c.data.profile)==null?void 0:D.display_name)||((M=c.data.profile)==null?void 0:M.username))??""}`)}),d(h,g)},$$slots:{default:!0}}),Ne()}export{vr as component};
