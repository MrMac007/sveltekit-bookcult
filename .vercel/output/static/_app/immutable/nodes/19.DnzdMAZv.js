import"../chunks/CWj6FrbW.js";import{p as X,h as H,V as E,f as c,m as P,a as s,c as e,d as F,t as N,i as C,g as d,s as n,b as Y,N as V,r as a,o as O,n as U}from"../chunks/OF3EgmvO.js";import{B as at,A as rt}from"../chunks/BGciXxwI.js";import{i as G}from"../chunks/wlFoaW_T.js";import{a as ot,e as st}from"../chunks/DECfYjIR.js";import{B as I,s as J,r as K,a as L}from"../chunks/DrwkzclB.js";import{T as it}from"../chunks/CwW5NFqH.js";import{C as M}from"../chunks/DzfTeG5e.js";import{C as Q}from"../chunks/DBJYfggh.js";import{C as lt,a as nt}from"../chunks/BNGQdwad.js";import{S as dt}from"../chunks/5TQJUeYt.js";import{g as vt}from"../chunks/Dky2jAKs.js";var ut=c('<img class="h-full w-full object-cover"/>'),ft=c('<div class="flex h-full w-full items-center justify-center"><!></div>'),ct=c('<p class="mt-1 text-sm text-muted-foreground"> </p>'),mt=c('<div class="flex gap-4"><div class="relative h-40 w-28 flex-shrink-0 overflow-hidden rounded-md bg-muted"><!></div> <div><h1 class="text-xl font-bold"> </h1> <!></div></div>'),_t=c('<div class="flex justify-center"><!></div> <div class="space-y-2"><label for="review" class="text-sm font-medium">Write a review (optional)</label> <!></div>',1),gt=c("<!> <!>",1),ht=c('<div class="space-y-6"><!> <form method="POST" class="space-y-6"><input type="hidden" name="book_id"/> <input type="hidden" name="rating"/> <!> <div class="flex gap-3"><!> <!></div></form></div>');function xt(S,t){X(t,!0);let _=H(E(t.existingRating||0)),B=H(E(t.existingReview||"")),v=H(!1);var k=ht(),$=e(k);M($,{children:(r,f)=>{Q(r,{class:"pt-6",children:(i,g)=>{var y=mt(),m=e(y),T=e(m);{var h=l=>{var o=ut();P(()=>{J(o,"src",t.book.cover_url),J(o,"alt",t.book.title)}),s(l,o)},x=l=>{var o=ft(),A=e(o);at(A,{class:"h-12 w-12 text-muted-foreground"}),a(o),s(l,o)};G(T,l=>{t.book.cover_url?l(h):l(x,!1)})}a(m);var b=n(m,2),p=e(b),z=e(p,!0);a(p);var R=n(p,2);{var tt=l=>{var o=ct(),A=e(o);a(o),P(et=>O(A,`by ${et??""}`),[()=>t.book.authors.join(", ")]),s(l,o)};G(R,l=>{t.book.authors&&t.book.authors.length>0&&l(tt)})}a(b),a(y),P(()=>O(z,t.book.title)),s(i,y)},$$slots:{default:!0}})},$$slots:{default:!0}});var w=n($,2),u=e(w);K(u);var j=n(u,2);K(j);var W=n(j,2);M(W,{children:(r,f)=>{var i=gt(),g=F(i);lt(g,{children:(m,T)=>{nt(m,{children:(h,x)=>{U();var b=N("How would you rate this book?");s(h,b)},$$slots:{default:!0}})},$$slots:{default:!0}});var y=n(g,2);Q(y,{class:"space-y-4",children:(m,T)=>{var h=_t(),x=F(h),b=e(x);dt(b,{get value(){return d(_)},onChange:R=>C(_,R,!0),size:"lg"}),a(x);var p=n(x,2),z=n(e(p),2);it(z,{id:"review",name:"review",placeholder:"Share your thoughts about this book...",rows:5,class:"resize-none",get value(){return d(B)},set value(R){C(B,R,!0)}}),a(p),s(m,h)},$$slots:{default:!0}}),s(r,i)},$$slots:{default:!0}});var q=n(W,2),D=e(q);I(D,{type:"button",variant:"outline",onclick:()=>window.history.back(),get disabled(){return d(v)},class:"flex-1",children:(r,f)=>{U();var i=N("Cancel");s(r,i)},$$slots:{default:!0}});var Z=n(D,2);{let r=V(()=>d(v)||d(_)===0);I(Z,{type:"submit",get disabled(){return d(r)},class:"flex-1",children:(f,i)=>{U();var g=N();P(()=>O(g,d(v)?"Submitting...":t.existingRating?"Update Rating":"Submit Rating")),s(f,g)},$$slots:{default:!0}})}a(q),a(w),ot(w,(r,f)=>{var i;return(i=st)==null?void 0:i(r,f)},()=>()=>(C(v,!0),async({result:r,update:f})=>{await f(),C(v,!1),r.type==="success"&&vt("/profile")})),a(k),P(()=>{L(u,t.book.id),L(j,d(_))}),s(S,k),Y()}var bt=c('<div class="mx-auto max-w-2xl px-4 py-6"><!></div>');function zt(S,t){X(t,!0),rt(S,{title:"Rate Book",children:(_,B)=>{var v=bt(),k=e(v);{let $=V(()=>{var u;return(u=t.data.existingRating)==null?void 0:u.rating}),w=V(()=>{var u;return(u=t.data.existingRating)==null?void 0:u.review});xt(k,{get book(){return t.data.book},get existingRating(){return d($)},get existingReview(){return d(w)}})}a(v),s(_,v)},$$slots:{default:!0}}),Y()}export{zt as component};
