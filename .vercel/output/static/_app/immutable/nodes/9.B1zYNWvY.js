import"../chunks/CWj6FrbW.js";import{p as dt,j as st,d as K,a as s,b as ct,f as n,c as e,r as t,s as d,m as p,o as f,g as C,N as nt,i as kt,h as wt,n as gt}from"../chunks/OF3EgmvO.js";import{i as _}from"../chunks/wlFoaW_T.js";import{B as Ct,C as _t,e as xt}from"../chunks/DzfTeG5e.js";import{U as At,B as ht,A as Bt}from"../chunks/BGciXxwI.js";import{C as ut}from"../chunks/DBJYfggh.js";import{c as mt}from"../chunks/Bm5gl4mz.js";import{g as ft,s as A,B as It}from"../chunks/DrwkzclB.js";import{p as Nt}from"../chunks/QIIHtePh.js";import{S as lt}from"../chunks/B5w8-l14.js";import{B as Pt}from"../chunks/DxOzrAxA.js";import{C as Tt,a as St}from"../chunks/GvTUSVzd.js";var jt=n('<a class="text-sm font-medium hover:underline"> </a>'),Lt=n('<span class="text-sm font-medium">Unknown user</span>'),Dt=n('<span class="text-xs text-muted-foreground">with review</span>'),Ut=n('<div class="mt-1 flex items-center gap-2"><div class="flex items-center gap-1"><!> <span class="text-sm font-semibold"> </span></div> <!></div>'),Et=n('<p class="mt-1.5 line-clamp-2 text-sm italic text-foreground/80"> </p>'),Ot=n('<div class="flex gap-3 border-l-2 border-muted pl-3 py-2"><div class="mt-0.5 flex-shrink-0"><!></div> <div class="min-w-0 flex-1"><div class="flex flex-wrap items-center gap-2"><!> <span class="text-sm text-muted-foreground"> </span> <span class="text-xs text-muted-foreground"> </span></div> <!> <!></div></div>'),Rt=n('<a class="font-medium hover:underline"> </a>'),Gt=n('<span class="font-medium">Unknown user</span>'),Ht=n('<a class="flex-shrink-0 transition-opacity hover:opacity-80"><img class="h-24 w-16 rounded object-cover"/></a>'),Mt=n('<img class="h-24 w-16 flex-shrink-0 rounded object-cover"/>'),zt=n('<a><h3 class="font-medium leading-tight line-clamp-2 transition-colors hover:text-primary"> </h3></a>'),Ft=n('<h3 class="font-medium leading-tight line-clamp-2"> </h3>'),Vt=n('<p class="text-sm text-muted-foreground line-clamp-1"> </p>'),qt=n('<span class="text-xs text-muted-foreground">with review</span>'),Jt=n('<div class="mt-2 flex items-center gap-2"><div class="flex items-center gap-1"><!> <span class="font-semibold"> </span></div> <!></div>'),Kt=n('<p class="mt-2 line-clamp-3 text-sm italic text-foreground/80"> </p>'),Qt=n('<div class="flex gap-4"><div class="mt-1 flex-shrink-0"><!></div> <div class="min-w-0 flex-1"><div class="mb-2 flex items-center gap-2"><!> <span class="text-sm text-muted-foreground"> </span> <span class="text-xs text-muted-foreground"> </span></div> <div class="flex gap-3"><!> <div class="min-w-0 flex-1"><!> <!> <!> <!></div></div></div></div>');function yt(H,a){dt(a,!0);let M=Nt(a,"compact",3,!1);function ot(){switch(a.activity.activity_type){case"wishlist_add":return{icon:ht,className:"h-5 w-5 text-blue-500"};case"book_complete":return{icon:Pt,className:"h-5 w-5 text-green-500"};case"rating_create":case"rating_update":return{icon:lt,className:"h-5 w-5 text-yellow-500 fill-yellow-500"};case"group_book_add":return{icon:At,className:"h-5 w-5 text-purple-500"};case"reading_started":default:return{icon:Ct,className:"h-5 w-5 text-orange-500"}}}function L(){var y;switch(a.activity.activity_type){case"wishlist_add":return"added to wishlist";case"book_complete":return"completed";case"rating_create":return"rated";case"rating_update":return"updated rating for";case"group_book_add":return(y=a.activity.metadata)!=null&&y.group_name?`added to ${a.activity.metadata.group_name}'s reading list`:"added to group reading list";case"reading_started":return"started reading";default:return"updated"}}const o=a.activity.metadata||{},b=a.activity.profiles,D=ot();var B=st(),I=K(B);{var N=y=>{var k=Ot(),T=e(k),S=e(T);mt(S,()=>D.icon,(c,l)=>{l(c,{get class(){return D.className}})}),t(T);var w=d(T,2),U=e(w),z=e(U);{var Y=c=>{var l=jt(),P=e(l,!0);t(l),p(()=>{A(l,"href",`/users/${b.id}`),f(P,b.display_name||b.username)}),s(c,l)},E=c=>{var l=Lt();s(c,l)};_(z,c=>{b?c(Y):c(E,!1)})}var j=d(z,2),Z=e(j,!0);t(j);var Q=d(j,2),et=e(Q);t(Q),t(U);var O=d(U,2);{var W=c=>{var l=Ut(),P=e(l),X=e(P);lt(X,{class:"h-3.5 w-3.5 fill-primary text-primary"});var v=d(X,2),u=e(v,!0);t(v),t(P);var R=d(P,2);{var F=V=>{var rt=Dt();s(V,rt)};_(R,V=>{o.has_review&&V(F)})}t(l),p(()=>f(u,o.rating)),s(c,l)};_(O,c=>{(a.activity.activity_type==="rating_create"||a.activity.activity_type==="rating_update")&&o.rating&&c(W)})}var $=d(O,2);{var tt=c=>{var l=Et(),P=e(l);t(l),p(()=>f(P,`"${o.review_snippet??""}"`)),s(c,l)};_($,c=>{o.review_snippet&&c(tt)})}t(w),t(k),p((c,l)=>{f(Z,c),f(et,`• ${l??""}`)},[L,()=>ft(a.activity.created_at)]),s(y,k)},h=y=>{_t(y,{children:(k,T)=>{ut(k,{class:"p-4",children:(S,w)=>{var U=Qt(),z=e(U),Y=e(z);mt(Y,()=>D.icon,(r,i)=>{i(r,{get class(){return D.className}})}),t(z);var E=d(z,2),j=e(E),Z=e(j);{var Q=r=>{var i=Rt(),g=e(i,!0);t(i),p(()=>{A(i,"href",`/users/${b.id}`),f(g,b.display_name||b.username)}),s(r,i)},et=r=>{var i=Gt();s(r,i)};_(Z,r=>{b?r(Q):r(et,!1)})}var O=d(Z,2),W=e(O,!0);t(O);var $=d(O,2),tt=e($);t($),t(j);var c=d(j,2),l=e(c);{var P=r=>{var i=st(),g=K(i);{var J=x=>{var m=Ht(),G=e(m);t(m),p(()=>{A(m,"href",`/book/${a.activity.book_id}`),A(G,"src",o.book_cover),A(G,"alt",o.book_title??"Book cover")}),s(x,m)},at=x=>{var m=Mt();p(()=>{A(m,"src",o.book_cover),A(m,"alt",o.book_title??"Book cover")}),s(x,m)};_(g,x=>{a.activity.book_id?x(J):x(at,!1)})}s(r,i)};_(l,r=>{o.book_cover&&r(P)})}var X=d(l,2),v=e(X);{var u=r=>{var i=st(),g=K(i);{var J=x=>{var m=zt(),G=e(m),it=e(G,!0);t(G),t(m),p(()=>{A(m,"href",`/book/${a.activity.book_id}`),f(it,o.book_title)}),s(x,m)},at=x=>{var m=Ft(),G=e(m,!0);t(m),p(()=>f(G,o.book_title)),s(x,m)};_(g,x=>{a.activity.book_id?x(J):x(at,!1)})}s(r,i)};_(v,r=>{o.book_title&&r(u)})}var R=d(v,2);{var F=r=>{var i=Vt(),g=e(i,!0);t(i),p(J=>f(g,J),[()=>o.book_authors.join(", ")]),s(r,i)};_(R,r=>{o.book_authors&&o.book_authors.length>0&&r(F)})}var V=d(R,2);{var rt=r=>{var i=Jt(),g=e(i),J=e(g);lt(J,{class:"h-4 w-4 fill-primary text-primary"});var at=d(J,2),x=e(at,!0);t(at),t(g);var m=d(g,2);{var G=it=>{var bt=qt();s(it,bt)};_(m,it=>{o.has_review&&it(G)})}t(i),p(()=>f(x,o.rating)),s(r,i)};_(V,r=>{(a.activity.activity_type==="rating_create"||a.activity.activity_type==="rating_update")&&o.rating&&r(rt)})}var vt=d(V,2);{var q=r=>{var i=Kt(),g=e(i);t(i),p(()=>f(g,`"${o.review_snippet??""}"`)),s(r,i)};_(vt,r=>{o.review_snippet&&r(q)})}t(X),t(c),t(E),t(U),p((r,i)=>{f(W,r),f(tt,`• ${i??""}`)},[L,()=>ft(a.activity.created_at)]),s(S,U)},$$slots:{default:!0}})},$$slots:{default:!0}})};_(I,y=>{M()?y(N):y(h,!1)})}s(H,B),ct()}var Wt=n('<img class="h-full w-full object-cover"/>'),Xt=n('<div class="flex h-full w-full items-center justify-center"><!></div>'),Yt=n('<p class="mt-0.5 line-clamp-1 text-sm text-muted-foreground"> </p>'),Zt=n("<!> Show less",1),$t=n("<!> ",1),ta=n('<div class="mb-4 flex gap-3 border-b pb-4"><a class="relative h-20 w-14 flex-shrink-0 overflow-hidden rounded bg-muted transition-opacity hover:opacity-80"><!></a> <div class="min-w-0 flex-1"><a><h3 class="font-semibold leading-tight line-clamp-2 transition-colors hover:text-primary"> </h3></a> <!> <div class="mt-2 flex items-center gap-2 text-xs"><span class="font-medium text-primary"> </span> <span class="text-muted-foreground">•</span> <span class="text-muted-foreground"> </span></div></div></div> <div class="space-y-3"></div> <!>',1);function aa(H,a){dt(a,!0);let M=wt(!1);const ot=5,L=4,o=nt(()=>a.group.activities.length>=ot),b=nt(()=>C(o)&&!C(M)?a.group.activities.slice(0,L):a.group.activities),D=nt(()=>Math.max(a.group.activities.length-L,0));function B(){const I=new Date,N=new Date(a.group.oldestDate),h=Math.floor((I.getTime()-N.getTime())/(1e3*60*60*24));return h===0?"Today":h===1?"Since yesterday":h<7?`Last ${h} days`:"Last week"}_t(H,{children:(I,N)=>{ut(I,{class:"p-4",children:(h,y)=>{var k=ta(),T=K(k),S=e(T),w=e(S);{var U=v=>{var u=Wt();p(()=>{A(u,"src",a.group.book_cover),A(u,"alt",a.group.book_title)}),s(v,u)},z=v=>{var u=Xt(),R=e(u);ht(R,{class:"h-6 w-6 text-muted-foreground"}),t(u),s(v,u)};_(w,v=>{a.group.book_cover?v(U):v(z,!1)})}t(S);var Y=d(S,2),E=e(Y),j=e(E),Z=e(j,!0);t(j),t(E);var Q=d(E,2);{var et=v=>{var u=Yt(),R=e(u);t(u),p(F=>f(R,`by ${F??""}`),[()=>a.group.book_authors.join(", ")]),s(v,u)};_(Q,v=>{a.group.book_authors&&a.group.book_authors.length>0&&v(et)})}var O=d(Q,2),W=e(O),$=e(W);t(W);var tt=d(W,4),c=e(tt,!0);t(tt),t(O),t(Y),t(T);var l=d(T,2);xt(l,21,()=>C(b),v=>v.id,(v,u)=>{yt(v,{get activity(){return C(u)},compact:!0})}),t(l);var P=d(l,2);{var X=v=>{It(v,{variant:"ghost",size:"sm",onclick:()=>kt(M,!C(M)),class:"mt-3 w-full text-sm",children:(u,R)=>{var F=st(),V=K(F);{var rt=q=>{var r=Zt(),i=K(r);Tt(i,{class:"mr-1.5 h-4 w-4"}),gt(),s(q,r)},vt=q=>{var r=$t(),i=K(r);St(i,{class:"mr-1.5 h-4 w-4"});var g=d(i);p(()=>f(g,` Show ${C(D)??""} more ${C(D)===1?"interaction":"interactions"}`)),s(q,r)};_(V,q=>{C(M)?q(rt):q(vt,!1)})}s(u,F)},$$slots:{default:!0}})};_(P,v=>{C(o)&&v(X)})}p(v=>{A(S,"href",`/book/${a.group.book_id}`),A(E,"href",`/book/${a.group.book_id}`),f(Z,a.group.book_title),f($,`${a.group.activities.length??""}
						${a.group.activities.length===1?" interaction":" interactions"}`),f(c,v)},[B]),s(h,k)},$$slots:{default:!0}})},$$slots:{default:!0}}),ct()}function pt(H){return"activities"in H&&Array.isArray(H.activities)}var ea=n('<p class="text-muted-foreground">No recent activity from users you follow.</p> <p class="mt-2 text-sm text-muted-foreground">Check back later to see what your friends are reading!</p>',1),ra=n('<div class="space-y-4"></div>'),ia=n('<div class="mx-auto max-w-2xl px-4 py-6"><!></div>');function ga(H,a){dt(a,!0),Bt(H,{title:"Feed",children:(M,ot)=>{var L=ia(),o=e(L);{var b=B=>{_t(B,{children:(I,N)=>{ut(I,{class:"p-8 text-center",children:(h,y)=>{var k=ea();gt(2),s(h,k)},$$slots:{default:!0}})},$$slots:{default:!0}})},D=B=>{var I=ra();xt(I,21,()=>a.data.feedItems,N=>pt(N)?`group-${N.book_id}`:N.id,(N,h)=>{var y=st(),k=K(y);{var T=w=>{aa(w,{get group(){return C(h)}})},S=w=>{yt(w,{get activity(){return C(h)}})};_(k,w=>{pt(C(h))?w(T):w(S,!1)})}s(N,y)}),t(I),s(B,I)};_(o,B=>{!a.data.feedItems||a.data.feedItems.length===0?B(b):B(D,!1)})}t(L),s(M,L)},$$slots:{default:!0}}),ct()}export{ga as component};
