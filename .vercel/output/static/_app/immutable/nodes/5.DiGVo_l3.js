import"../chunks/CWj6FrbW.js";import{p as ze,h as ue,V as Ne,u as Se,i as x,g as v,f as s,d as h,c as o,s as l,r as t,m as _,a as r,b as Fe,j as We,N as De,n as z,o as p,t as Ke}from"../chunks/OF3EgmvO.js";import{B as ke,A as Qe}from"../chunks/BGciXxwI.js";import{i as n}from"../chunks/wlFoaW_T.js";import{B as Xe,C as be,e as Ue,i as Me}from"../chunks/DzfTeG5e.js";import{d as we,B as ye,s as Ce,c as Ie}from"../chunks/DrwkzclB.js";import{p as M}from"../chunks/QIIHtePh.js";import{C as xe}from"../chunks/DBJYfggh.js";import{B as pe}from"../chunks/BMF07ZcG.js";import{S as Ge}from"../chunks/5TQJUeYt.js";import{a as Oe,e as Ye}from"../chunks/DECfYjIR.js";import{C as Je}from"../chunks/FUsgEz7N.js";import{B as Ze}from"../chunks/DxOzrAxA.js";import{S as Ve}from"../chunks/CnjVKNr5.js";import{L as $e}from"../chunks/peaLEW31.js";import{S as ea}from"../chunks/B5w8-l14.js";var aa=s("<!> In Wishlist",1),ta=s("<!> Add to Wishlist",1),ra=s("<!> Reading",1),oa=s("<!> Start Reading",1),sa=s('<form method="POST"><!></form> <form method="POST"><!></form>',1),ia=s("<!> ",1),la=s('<form method="POST" action="?/markComplete"><!></form>'),na=s('<div class="mt-3 rounded-lg border border-green-200 bg-green-50 p-3 text-sm text-green-800 dark:border-green-800 dark:bg-green-950 dark:text-green-200"> </div>'),da=s("<div><!> <!></div> <!>",1);function va(_e,e){ze(e,!0);let te=M(e,"isInWishlist",3,!1),oe=M(e,"isCurrentlyReading",3,!1),V=M(e,"isCompleted",3,!1),$=M(e,"showCompleteButton",3,!0),se=M(e,"layout",3,"horizontal"),je=M(e,"class",3,""),q=ue(!1),F=ue(""),ee=ue(Ne(te())),ie=ue(Ne(oe())),H=ue(Ne(V()));Se(()=>{x(ee,te())}),Se(()=>{x(ie,oe())}),Se(()=>{x(H,V())}),Se(()=>{if(v(F)){const R=setTimeout(()=>{x(F,"")},3e3);return()=>clearTimeout(R)}});const fe=se()==="vertical"?"flex flex-col gap-3":"flex gap-3";var de=da(),ve=h(de),Pe=o(ve);{var Ae=R=>{var W=sa(),G=h(W),L=o(G);{let f=De(()=>v(ee)?"outline":"default");ye(L,{type:"submit",get variant(){return v(f)},get disabled(){return v(q)},class:"w-full",children:(B,D)=>{var ae=We(),ge=h(ae);{var ce=j=>{var K=aa(),he=h(K);Je(he,{class:"mr-2 h-4 w-4"}),z(),r(j,K)},Q=j=>{var K=ta(),he=h(K);ke(he,{class:"mr-2 h-4 w-4"}),z(),r(j,K)};n(ge,j=>{v(ee)?j(ce):j(Q,!1)})}r(B,ae)},$$slots:{default:!0}})}t(G),Oe(G,(f,B)=>{var D;return(D=Ye)==null?void 0:D(f,B)},()=>()=>(x(q,!0),x(ee,!v(ee)),async({result:f,update:B})=>{await B(),x(q,!1),f.type==="success"&&f.data&&f.data.message&&x(F,f.data.message,!0)}));var U=l(G,2),re=o(U);ye(re,{type:"submit",variant:"outline",get disabled(){return v(q)},class:"w-full",children:(f,B)=>{var D=We(),ae=h(D);{var ge=Q=>{var j=ra(),K=h(j);Je(K,{class:"mr-2 h-4 w-4"}),z(),r(Q,j)},ce=Q=>{var j=oa(),K=h(j);Xe(K,{class:"mr-2 h-4 w-4"}),z(),r(Q,j)};n(ae,Q=>{v(ie)?Q(ge):Q(ce,!1)})}r(f,D)},$$slots:{default:!0}}),t(U),Oe(U,(f,B)=>{var D;return(D=Ye)==null?void 0:D(f,B)},()=>()=>(x(q,!0),x(ie,!v(ie)),async({result:f,update:B})=>{await B(),x(q,!1),f.type==="success"&&f.data&&f.data.message&&x(F,f.data.message,!0)})),_(()=>{Ce(G,"action",v(ee)?"?/removeFromWishlist":"?/addToWishlist"),we(G,1,Ie(se()==="vertical"?"w-full":"flex-1")),Ce(U,"action",v(ie)?"?/stopReading":"?/startReading"),we(U,1,Ie(se()==="vertical"?"w-full":"flex-1"))}),r(R,W)};n(Pe,R=>{v(H)||R(Ae)})}var me=l(Pe,2);{var Ee=R=>{var W=la(),G=o(W);{let L=De(()=>v(H)?"secondary":"outline"),U=De(()=>v(q)||v(H));ye(G,{type:"submit",get variant(){return v(L)},get disabled(){return v(U)},class:"w-full",children:(re,f)=>{var B=ia(),D=h(B);Ze(D,{class:"mr-2 h-4 w-4"});var ae=l(D);_(()=>p(ae,` ${v(H)?"Completed":"Mark Complete"}`)),r(re,B)},$$slots:{default:!0}})}t(W),Oe(W,(L,U)=>{var re;return(re=Ye)==null?void 0:re(L,U)},()=>()=>(x(q,!0),x(H,!0),async({result:L,update:U})=>{await U(),x(q,!1),L.type==="success"&&L.data&&L.data.message&&x(F,L.data.message,!0)})),_(()=>we(W,1,Ie(se()==="vertical"?"w-full":"flex-1"))),r(R,W)};n(me,R=>{$()&&R(Ee)})}t(ve);var Re=l(ve,2);{var Te=R=>{var W=na(),G=o(W,!0);t(W),_(()=>p(G,v(F))),r(R,W)};n(Re,R=>{v(F)&&R(Te)})}_(()=>we(ve,1,`${fe} ${je()??""}`)),r(_e,de),Fe()}var ca=s('<img class="h-full w-full object-cover"/>'),ua=s('<div class="flex h-full w-full items-center justify-center"><!></div>'),_a=s('<p class="mt-2 text-lg text-muted-foreground"> </p>'),fa=s("<span> </span>"),ma=s("<span>â€¢</span>"),ga=s("<span> </span>"),ha=s('<div><p class="text-2xl font-bold text-primary"> </p> <p class="text-sm text-muted-foreground">Pages</p></div>'),ba=s('<div><p class="text-2xl font-bold text-primary"> </p> <p class="text-sm text-muted-foreground">Published</p></div>'),xa=s('<div class="grid grid-cols-2 gap-4 text-center md:grid-cols-3"><!> <!></div>'),pa=s('<div class="mb-6"><!></div>'),ka=s("<!> In Wishlist",1),wa=s("<!> Currently Reading",1),ya=s("<!> Completed",1),Ca=s('<h3 class="mb-3 font-semibold">Your Status</h3> <div class="flex flex-wrap gap-2"><!> <!> <!></div>',1),Pa=s('<p class="mt-3 text-sm text-foreground/80"> </p>'),Ra=s('<div class="flex items-center justify-between"><h3 class="font-semibold">Your Rating</h3> <a class="text-sm text-primary hover:underline">Edit</a></div> <div class="mt-3"><!> <!> <p class="mt-2 text-xs text-muted-foreground"> </p></div>',1),Ba=s("<!> Rate this Book",1),Sa=s('<div class="mb-6"><!></div>'),Ia=s("<!> AI Enhanced",1),Wa=s('<span class="flex items-center gap-1.5"><!> Enhancing...</span>'),ja=s('<span class="flex items-center gap-1.5"><!> Enhance with AI</span>'),Aa=s('<div><h3 class="mb-2 font-semibold">Description</h3> <p class="text-sm leading-relaxed text-foreground/80"> </p></div>'),Ea=s('<div><h3 class="mb-2 font-semibold">Categories</h3> <div class="flex flex-wrap gap-2"></div></div>'),Ta=s('<div><h3 class="mb-2 font-semibold">Page Count</h3> <p class="text-sm text-foreground/80"> </p></div>'),Na=s("<p> </p>"),Da=s("<p> </p>"),Oa=s('<div><h3 class="mb-2 font-semibold">ISBN</h3> <div class="text-sm text-foreground/80"><!> <!></div></div>'),Ya=s('<div class="flex items-center justify-between"><h3 class="font-semibold">About this book</h3> <!></div> <!> <!> <!> <!>',1),za=s('<p class="mt-2 text-sm text-foreground/80"> </p>'),Fa=s('<div class="border-b pb-4 last:border-b-0 last:pb-0"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-2"><p class="text-sm font-medium"> </p> <!></div> <!> <p class="mt-1 text-xs text-muted-foreground"> </p></div></div></div>'),La=s('<h3 class="mb-4 font-semibold">Ratings from Your Groups</h3> <div class="space-y-4"></div>',1),Ua=s('<div><div class="mb-8 text-center"><div class="relative mx-auto mb-4 h-60 w-40 overflow-hidden rounded-lg bg-muted"><!></div> <h1 class="page-heading text-center text-2xl"> </h1> <!> <div class="mt-2 flex items-center justify-center gap-2 text-sm text-muted-foreground"><!> <!> <!></div></div> <!> <!> <!> <!> <!> <!></div>');function Ma(_e,e){ze(e,!0);let te=M(e,"isInWishlist",3,!1),oe=M(e,"isCurrentlyReading",3,!1),V=M(e,"isCompleted",3,!1),$=M(e,"userRating",3,null),se=M(e,"groupRatings",19,()=>[]),je=M(e,"showActions",3,!0),q=M(e,"class",3,""),F=ue(!1);const ee=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"";async function ie(){if(!(!e.book.id||v(F))){x(F,!0);try{const a=await fetch("/api/books/enhance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:e.book.id}),credentials:"same-origin"}),i=await a.json();a.ok&&i.success?window.location.reload():(console.error("Enhance error:",i.error),alert(i.error||"Failed to enhance book"))}catch(a){console.error("Error enhancing book:",a),alert("An unexpected error occurred. Please try again.")}finally{x(F,!1)}}}var H=Ua(),fe=o(H),de=o(fe),ve=o(de);{var Pe=a=>{var i=ca();_(()=>{Ce(i,"src",e.book.cover_url),Ce(i,"alt",`Cover of ${e.book.title??""}`)}),r(a,i)},Ae=a=>{var i=ua(),k=o(i);ke(k,{class:"h-16 w-16 text-muted-foreground"}),t(i),r(a,i)};n(ve,a=>{e.book.cover_url?a(Pe):a(Ae,!1)})}t(de);var me=l(de,2),Ee=o(me,!0);t(me);var Re=l(me,2);{var Te=a=>{var i=_a(),k=o(i);t(i),_(O=>p(k,`by ${O??""}`),[()=>e.book.authors.join(", ")]),r(a,i)};n(Re,a=>{e.book.authors&&e.book.authors.length>0&&a(Te)})}var R=l(Re,2),W=o(R);{var G=a=>{var i=fa(),k=o(i,!0);t(i),_(()=>p(k,e.book.publisher)),r(a,i)};n(W,a=>{e.book.publisher&&a(G)})}var L=l(W,2);{var U=a=>{var i=ma();r(a,i)};n(L,a=>{e.book.published_date&&e.book.publisher&&a(U)})}var re=l(L,2);{var f=a=>{var i=ga(),k=o(i,!0);t(i),_(O=>p(k,O),[()=>new Date(e.book.published_date).getFullYear()]),r(a,i)};n(re,a=>{e.book.published_date&&a(f)})}t(R),t(fe);var B=l(fe,2);{var D=a=>{be(a,{class:"mb-6",children:(i,k)=>{xe(i,{class:"pt-6",children:(O,X)=>{var m=xa(),S=o(m);{var J=b=>{var y=ha(),I=o(y),c=o(I,!0);t(I),z(2),t(y),_(()=>p(c,e.book.page_count)),r(b,y)};n(S,b=>{e.book.page_count&&b(J)})}var A=l(S,2);{var w=b=>{var y=ba(),I=o(y),c=o(I,!0);t(I),z(2),t(y),_(C=>p(c,C),[()=>new Date(e.book.published_date).getFullYear()]),r(b,y)};n(A,b=>{e.book.published_date&&b(w)})}t(m),r(O,m)},$$slots:{default:!0}})},$$slots:{default:!0}})};n(B,a=>{(e.book.page_count||e.book.published_date)&&a(D)})}var ae=l(B,2);{var ge=a=>{var i=pa(),k=o(i);va(k,{get bookId(){return e.book.id},get isInWishlist(){return te()},get isCurrentlyReading(){return oe()},get isCompleted(){return V()},showCompleteButton:!0}),t(i),r(a,i)};n(ae,a=>{je()&&a(ge)})}var ce=l(ae,2);{var Q=a=>{be(a,{class:"mb-6",children:(i,k)=>{xe(i,{class:"pt-6",children:(O,X)=>{var m=Ca(),S=l(h(m),2),J=o(S);{var A=c=>{pe(c,{variant:"secondary",class:"gap-1.5",children:(C,Z)=>{var E=ka(),d=h(E);ke(d,{class:"h-3 w-3"}),z(),r(C,E)},$$slots:{default:!0}})};n(J,c=>{te()&&c(A)})}var w=l(J,2);{var b=c=>{pe(c,{variant:"secondary",class:"gap-1.5",children:(C,Z)=>{var E=wa(),d=h(E);ke(d,{class:"h-3 w-3"}),z(),r(C,E)},$$slots:{default:!0}})};n(w,c=>{oe()&&c(b)})}var y=l(w,2);{var I=c=>{pe(c,{variant:"secondary",class:"gap-1.5",children:(C,Z)=>{var E=ya(),d=h(E);ke(d,{class:"h-3 w-3"}),z(),r(C,E)},$$slots:{default:!0}})};n(y,c=>{V()&&c(I)})}t(S),r(O,m)},$$slots:{default:!0}})},$$slots:{default:!0}})};n(ce,a=>{(te()||oe()||V())&&a(Q)})}var j=l(ce,2);{var K=a=>{be(a,{class:"mb-6",children:(i,k)=>{xe(i,{class:"pt-6",children:(O,X)=>{var m=Ra(),S=h(m),J=l(o(S),2);t(S);var A=l(S,2),w=o(A);Ge(w,{get value(){return $().rating},readonly:!0,size:"md"});var b=l(w,2);{var y=C=>{var Z=Pa(),E=o(Z,!0);t(Z),_(()=>p(E,$().review)),r(C,Z)};n(b,C=>{$().review&&C(y)})}var I=l(b,2),c=o(I);t(I),t(A),_(C=>{Ce(J,"href",`/rate/${e.book.id??""}`),p(c,`Rated on ${C??""}`)},[()=>ee($().created_at)]),r(O,m)},$$slots:{default:!0}})},$$slots:{default:!0}})},he=a=>{var i=We(),k=h(i);{var O=X=>{var m=Sa(),S=o(m);ye(S,{onclick:()=>window.location.href=`/rate/${e.book.id}`,class:"w-full",children:(J,A)=>{var w=Ba(),b=h(w);ea(b,{class:"mr-2 h-4 w-4"}),z(),r(J,w)},$$slots:{default:!0}}),t(m),r(X,m)};n(k,X=>{V()&&X(O)},!0)}r(a,i)};n(j,a=>{$()?a(K):a(he,!1)})}var Le=l(j,2);be(Le,{class:"mb-6",children:(a,i)=>{xe(a,{class:"space-y-4 pt-6",children:(k,O)=>{var X=Ya(),m=h(X),S=l(o(m),2);{var J=d=>{pe(d,{variant:"secondary",class:"gap-1.5",children:(u,T)=>{var g=Ia(),Y=h(g);Ve(Y,{class:"h-3 w-3"}),z(),r(u,g)},$$slots:{default:!0}})},A=d=>{ye(d,{variant:"outline",size:"sm",class:"gap-1.5",onclick:ie,get disabled(){return v(F)},children:(u,T)=>{var g=We(),Y=h(g);{var le=P=>{var N=Wa(),ne=o(N);$e(ne,{class:"h-3.5 w-3.5 animate-spin"}),z(),t(N),r(P,N)},Be=P=>{var N=ja(),ne=o(N);Ve(ne,{class:"h-3.5 w-3.5"}),z(),t(N),r(P,N)};n(Y,P=>{v(F)?P(le):P(Be,!1)})}r(u,g)},$$slots:{default:!0}})};n(S,d=>{e.book.ai_enhanced?d(J):d(A,!1)})}t(m);var w=l(m,2);{var b=d=>{var u=Aa(),T=l(o(u),2),g=o(T,!0);t(T),t(u),_(()=>p(g,e.book.description)),r(d,u)};n(w,d=>{e.book.description&&d(b)})}var y=l(w,2);{var I=d=>{var u=Ea(),T=l(o(u),2);Ue(T,21,()=>e.book.categories,Me,(g,Y)=>{pe(g,{variant:"secondary",children:(le,Be)=>{z();var P=Ke();_(()=>p(P,v(Y))),r(le,P)},$$slots:{default:!0}})}),t(T),t(u),r(d,u)};n(y,d=>{e.book.categories&&e.book.categories.length>0&&d(I)})}var c=l(y,2);{var C=d=>{var u=Ta(),T=l(o(u),2),g=o(T);t(T),t(u),_(()=>p(g,`${e.book.page_count??""} pages`)),r(d,u)};n(c,d=>{e.book.page_count&&d(C)})}var Z=l(c,2);{var E=d=>{var u=Oa(),T=l(o(u),2),g=o(T);{var Y=P=>{var N=Na(),ne=o(N);t(N),_(()=>p(ne,`ISBN-13: ${e.book.isbn_13??""}`)),r(P,N)};n(g,P=>{e.book.isbn_13&&P(Y)})}var le=l(g,2);{var Be=P=>{var N=Da(),ne=o(N);t(N),_(()=>p(ne,`ISBN-10: ${e.book.isbn_10??""}`)),r(P,N)};n(le,P=>{e.book.isbn_10&&P(Be)})}t(T),t(u),r(d,u)};n(Z,d=>{(e.book.isbn_13||e.book.isbn_10)&&d(E)})}r(k,X)},$$slots:{default:!0}})},$$slots:{default:!0}});var qe=l(Le,2);{var He=a=>{be(a,{children:(i,k)=>{xe(i,{class:"pt-6",children:(O,X)=>{var m=La(),S=l(h(m),2);Ue(S,21,se,Me,(J,A)=>{var w=Fa(),b=o(w),y=o(b),I=o(y),c=o(I),C=o(c,!0);t(c);var Z=l(c,2);Ge(Z,{get value(){return v(A).rating},readonly:!0,size:"sm"}),t(I);var E=l(I,2);{var d=g=>{var Y=za(),le=o(Y,!0);t(Y),_(()=>p(le,v(A).review)),r(g,Y)};n(E,g=>{v(A).review&&g(d)})}var u=l(E,2),T=o(u,!0);t(u),t(y),t(b),t(w),_(g=>{var Y;p(C,((Y=v(A).profiles)==null?void 0:Y.username)||"Unknown User"),p(T,g)},[()=>ee(v(A).created_at)]),r(J,w)}),t(S),r(O,m)},$$slots:{default:!0}})},$$slots:{default:!0}})};n(qe,a=>{se().length>0&&a(He)})}t(H),_(()=>{we(H,1,Ie(q())),p(Ee,e.book.title)}),r(_e,H),Fe()}var Ga=s('<div class="mx-auto max-w-2xl px-4 py-6"><!></div>');function lt(_e,e){ze(e,!0),Qe(_e,{get title(){return e.data.book.title},showLogo:!1,children:(te,oe)=>{var V=Ga(),$=o(V);Ma($,{get book(){return e.data.book},get isInWishlist(){return e.data.isInWishlist},get isCurrentlyReading(){return e.data.isCurrentlyReading},get isCompleted(){return e.data.isCompleted},get userRating(){return e.data.userRating},get groupRatings(){return e.data.groupRatings},showActions:!0}),t(V),r(te,V)},$$slots:{default:!0}}),Fe()}export{lt as component};
